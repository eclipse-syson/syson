= Developer guide

This developer guide provides step-by-step instructions on how to set up your developer environment, contribute to the codebase, and enhance the capability of {product}.

== Retrieving the Source Code

{product} is built upon the https://eclipse.dev/sirius/sirius-web.html[Eclipse Sirius Web] project.
{product} is licensed under the xref:product-legal:index.adoc[(EPL v2)] Open Source license
The source code is openly accessible on GitHub:{source-code-url}

To get the source code, clone the repository using either SSH:

[source, bash]
----
git clone git@github.com:eclipse-syson/syson.git
----

or HTTPS:

[source, bash]
----
git clone https://github.com/eclipse-syson/syson.git
----

== Setting Up your Development Environment

. Download your coding environment https://spring.io/tools[Spring Tools 4.22.0] (or newer).
. Ensure that m2e version from your environment is >= 2.6.0
+
image::environment-m2e-version.png[m2e version]
+
. Retrieve the source code or fork it if you want to make contribution
. Import _backend_ plugins from {product} repository in your workspace
. Update _settings.xml_ file from your _.m2_ folder to give access to other repositories during the build
  In order to see dependence with access to add in _settings.xml_, have a look on _backend\application\syson-application\pom.xml_
  You need to create https://github.com/settings/tokens[access tokens] on Github to complete _settings.xml_.
+
image::environment-settings.png[settings file]
+
. Right click on _syson-services_ module and then _Properties>JavaBuildPath>Source_
  Add _main/generated_ folder and remove _excluded_ content and former _antlr/grammar_
  You should retrieve the following _Java build path_
+
image::environment-java-build-path.png[Java build path]
+
. Update Maven project by launching "ALT+F5" shortcut on all modules of your workspace

== Generate a new version of SysIDE CLI

In the _syson-import_ module, you'll found a `syside-cli-.js` file in `src/main/resources`.
This file is used by the import process, to parse the {sysmlv2} textual files.
If you want to update the version on SysIDE used to parse textual files, you need to generate a new version of this `syside-cli-.js` file.

Here are the steps to follow:

. Clone the https://github.com/sensmetry/sysml-2ls[SysIDE repository] from github.
. Install https://pnpm.io/installation[pnpm].
. Go to the root of your local SysIDE repository.
. Execute `pnpm install` command.
. Execute `pnpm run build` command.
. Execute `pnpm run --dir packages/syside-cli/ esbuild` command.
. It produces a `your_local_syside_repo/packages/syside-cli/out/index.js` file
. Get a copy of the `your-local-syside-repo/packages/syside-cli/out/index.js` file.
. Edit this file:
.. add `#!/usr/bin/env node` as first line
.. add `src_default();` as last line
.. rename it to `syside-cli.js`
. Copy the renamed file into `your_local_syson_repo/backend/application/syson-import/src/main/resources` (overwrite the existing file).

== Generate a new OpenAPI documentation of REST API

. Build and run the syson server locally (using docker compose as example) on `http://localhost:8080`.
. Download the documentation at the url: `http://localhost:8080/v3/api-docs/rest-apis`.
. The swagger-ui user interface is `http://localhost:8080/swagger-ui/index.html`.

[#services_organization]
== Services organization

Since version 2025.10.2, {product} services are organized into several modules to improve maintainability and scalability.

- Services that query/mutate the model are located in the module `syson-sysml-metamodel-services`.
* this module will depend on `syson-sysml-metamodel`.
* all services in this module won't depend on Spring, Sirius-Web or any diagram/table related code.
- Services that query/mutate the model through Sirius-Web services are located in the module `syson-model-services`.
* all services in this module are allowed to depend on Sirius-Web
* for example, services that query the model through `IObjectSearchService`.
- Services that query/mutate a diagram are located in the module `syson-diagram-services`.
* all services in this module are allowed to depend on Sirius-Web.
- Services that query/mutate a table are located in the module `syson-table-services`.
* all services in this module are allowed to depend on Sirius-Web.
- Services that query/mutate a tree are located in the module `syson-tree-services`.
* all services in this module are allowed to depend on Sirius-Web.
- Services that query/mutate a form are located in the module `syson-form-services`.
* all services in this module are allowed to depend on Sirius-Web.
- Services that query/mutate and are transversal/common to any representation are located in the module `syson-representation-services`.
* all services in this module are allowed to depend on Sirius-Web.
* will contain services that can be used in all representations

- Services will be grouped in classes by their purpose and usage:
* a service that query the model will be in a class named `ModelQueryService`.
* a service that mutate the model will be in a class named `ModelMutationService`.
* a service that query the diagram will be in a class named `DiagramQueryService`.
* a service that mutate the diagram will be in a class named `DiagramMutationService`.
* a service querying label of diagram elements will be in a class named `DiagramQueryLabelService`.
* a service modifying the label of diagram elements will be in a class named `DiagramMutationLabelService`.
* same for tables, trees, forms, representations.
* `XXXQueryService`, `XXXMutationService`, `XXXQueryYYYService`, `XXXMutationYYYService` classes can be split in smaller classes if they contain too many services.

- In addition to services classes, each module contains two specific services classes which are the entry points for services that are intended to be called from AQL expressions:
* these classes contain services that are intended to be called from AQL expressions.
* they are suffixed by _AQLService_.
* their only role are to expose services from other service classes.
* other service classes are not suffixed by _AQLService_ and contain services that are intended to be called from Java code or by _AQLService_ classes.

To help you understand this new organization, and how to add new services, please refer to the schema below:

image::dev-guide-how-to-create-a-service.png[Services organization schema, width=85%,height=85%]

Old services that were in the `syson-services`, `syson-diagram-common-view`, `syson-standard-diagrams-view` modules will be migrated to the appropriate new modules in the next releases.